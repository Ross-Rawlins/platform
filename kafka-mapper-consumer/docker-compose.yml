version: '3.9'

services:
  kafka-mapper-consumer:
    image: jembi/kafka-mapper-consumer
    environment:
      KAFKA_HOST: ${KAFKA_HOST:-kafka}
      KAFKA_PORT: ${KAFKA_PORT:-9092}
      CLICKHOUSE_HOST: ${CLICKHOUSE_HOST:-analytics-datastore-clickhouse}
      CLICKHOUSE_PORT: ${CLICKHOUSE_PORT:-8123}
    configs:
      - target: /app/src/data/fhir-mapping.json
        source: fhir-mapping.json

configs:
  fhir-mapping.json:
    file: ./fhir-mapping.json
    name: fhir-mapping.json-${fhir_mapping_json_DIGEST:?err}
    labels:
      name: kafka-mapper-consumer
      tag: kafka-mapper-consumer-fhir-mapping.json
